<div class="register-container">
  <!-- Embers Background -->
  <app-ember-background density="sparse"></app-ember-background>

  <!-- Back to Home -->
  <a routerLink="/" class="back-home">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
    </svg>
    <span>Nazad na početnu</span>
  </a>

  <div class="register-wrapper">
    <!-- Info Panel -->
    <div class="info-panel">
      <a routerLink="/" class="brand-link">
        <h1 class="brand-title">REIGNITE</h1>
      </a>
      <div class="info-content">
        <h2 class="info-heading">Pridruži se zajednici</h2>
        <p class="info-text">
          Kreiraj, dijeli i inspiriši. Postani dio zajednice kreativnih ljudi koji stvaraju nešto posebno.
        </p>
        <ul class="info-list">
          <li>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
            </svg>
            <span>Pristup ekskluzivnim setovima</span>
          </li>
          <li>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
            </svg>
            <span>Dijeli svoje projekte</span>
          </li>
          <li>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
            </svg>
            <span>Povezuj se sa drugima</span>
          </li>
        </ul>
      </div>
    </div>

    <!-- Register Card -->
    <div class="register-card">
      <div class="card-header">
        <h2 class="card-title">Kreiraj Račun</h2>
        <p class="card-subtitle">Popuni podatke za registraciju</p>
      </div>

      @if (errorMessage()) {
        <div class="error-alert">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z" />
          </svg>
          <span>{{ errorMessage() }}</span>
        </div>
      }

      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">
        <!-- Name Row -->
        <div class="form-row">
          <div class="form-group">
            <label for="firstName" class="form-label">Ime</label>
            <input
              type="text"
              id="firstName"
              formControlName="firstName"
              class="form-input"
              [class.error]="hasError('firstName', 'required') || hasError('firstName', 'minlength')"
              placeholder="Vaše ime"
              autocomplete="given-name">
            @if (hasError('firstName', 'required')) {
              <span class="error-message">Ime je obavezno</span>
            } @else if (hasError('firstName', 'minlength')) {
              <span class="error-message">Minimalno 2 karaktera</span>
            }
          </div>

          <div class="form-group">
            <label for="lastName" class="form-label">Prezime</label>
            <input
              type="text"
              id="lastName"
              formControlName="lastName"
              class="form-input"
              [class.error]="hasError('lastName', 'required') || hasError('lastName', 'minlength')"
              placeholder="Vaše prezime"
              autocomplete="family-name">
            @if (hasError('lastName', 'required')) {
              <span class="error-message">Prezime je obavezno</span>
            } @else if (hasError('lastName', 'minlength')) {
              <span class="error-message">Minimalno 2 karaktera</span>
            }
          </div>
        </div>

        <!-- Username -->
        <div class="form-group">
          <label for="username" class="form-label">Korisničko ime</label>
          <input
            type="text"
            id="username"
            formControlName="username"
            class="form-input"
            [class.error]="hasError('username', 'required') || hasError('username', 'minlength')"
            placeholder="Izaberite korisničko ime"
            autocomplete="username">
          @if (hasError('username', 'required')) {
            <span class="error-message">Korisničko ime je obavezno</span>
          } @else if (hasError('username', 'minlength')) {
            <span class="error-message">Minimalno 4 karaktera</span>
          }
        </div>

        <!-- Email -->
        <div class="form-group">
          <label for="email" class="form-label">Email</label>
          <input
            type="email"
            id="email"
            formControlName="email"
            class="form-input"
            [class.error]="hasError('email', 'required') || hasError('email', 'email')"
            placeholder="vas@email.com"
            autocomplete="email">
          @if (hasError('email', 'required')) {
            <span class="error-message">Email je obavezan</span>
          } @else if (hasError('email', 'email')) {
            <span class="error-message">Unesite validan email</span>
          }
        </div>

        <!-- Phone -->
        <div class="form-group">
          <label for="phoneNumber" class="form-label">Broj telefona</label>
          <input
            type="tel"
            id="phoneNumber"
            formControlName="phoneNumber"
            class="form-input"
            [class.error]="hasError('phoneNumber', 'required') || hasError('phoneNumber', 'pattern')"
            placeholder="+387 6X XXX XXX"
            autocomplete="tel">
          @if (hasError('phoneNumber', 'required')) {
            <span class="error-message">Broj telefona je obavezan</span>
          } @else if (hasError('phoneNumber', 'pattern')) {
            <span class="error-message">Format: +387 6X XXX XXX ili 06X XXX XXX</span>
          }
        </div>

        <!-- Password Row -->
        <div class="form-row">
          <div class="form-group">
            <label for="password" class="form-label">Lozinka</label>
            <div class="password-input-wrapper">
              <input
                [type]="showPassword() ? 'text' : 'password'"
                id="password"
                formControlName="password"
                class="form-input"
                [class.error]="hasError('password', 'required') || hasError('password', 'minlength')"
                placeholder="••••••••"
                autocomplete="new-password">
              <button type="button" class="password-toggle" (click)="togglePassword()">
                @if (showPassword()) {
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                  </svg>
                } @else {
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                  </svg>
                }
              </button>
            </div>
            @if (hasError('password', 'required')) {
              <span class="error-message">Lozinka je obavezna</span>
            } @else if (hasError('password', 'minlength')) {
              <span class="error-message">Min. 6 karaktera</span>
            }
          </div>

          <div class="form-group">
            <label for="confirmPassword" class="form-label">Potvrdi lozinku</label>
            <div class="password-input-wrapper">
              <input
                [type]="showConfirmPassword() ? 'text' : 'password'"
                id="confirmPassword"
                formControlName="confirmPassword"
                class="form-input"
                [class.error]="hasError('confirmPassword', 'required') || hasError('confirmPassword', 'passwordMismatch')"
                placeholder="••••••••"
                autocomplete="new-password">
              <button type="button" class="password-toggle" (click)="toggleConfirmPassword()">
                @if (showConfirmPassword()) {
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                  </svg>
                } @else {
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                  </svg>
                }
              </button>
            </div>
            @if (hasError('confirmPassword', 'required')) {
              <span class="error-message">Potvrdite lozinku</span>
            } @else if (hasError('confirmPassword', 'passwordMismatch')) {
              <span class="error-message">Lozinke se ne podudaraju</span>
            }
          </div>
        </div>

        <button type="submit" class="submit-button" [disabled]="isLoading()">
          @if (isLoading()) {
            <span class="loading-spinner"></span>
            <span>Registracija...</span>
          } @else {
            <span>Registruj Se</span>
          }
        </button>
      </form>

      <div class="card-footer">
        <p>Već imate račun? <a routerLink="/login" class="link">Prijavite se</a></p>
      </div>
    </div>
  </div>
</div>
